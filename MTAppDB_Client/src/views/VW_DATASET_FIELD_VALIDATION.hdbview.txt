VIEW "VW_DATASET_FIELD_VALIDATION" ( "DATASET_FIELD_VALIDATION_ID",
	 "SEQUENCE_ID",
	 "DATASET_FIELD_ID",
	 "DATASET_FIELD_NAME",
	 "DATASET_FIELD_DESCRIPTION",
	 "DATASET_TYPE_ID",
	 "DATASET_TYPE_NAME",
	 "DATASET_TYPE_DESCRIPTION",
	 "DM_DATASET_TYPE_ID",
	 "DM_NK_FIELD_ID",
	 "FIELD_VALUE",
	 "UDV",
	 "EXCEPTION_CODE",
	 "EXCEPTION_SEVERITY",
	 "TAX_YEAR",
	 "OBLIGATION_ID",
	 "FI_ID",
	 "ENTITY_ID",
	 "ENTITY_CODE",
	 "ENTITY_NAME",
	 "FI_ACCOUNT_ID",
	 "FI_ACCOUNT_CODE",
	 "FI_ACCOUNT_NAME",
	 "FI_HOLDER_ID",
	 "FI_HOLDER_CODE",
	 "FI_HOLDER_FULL_NAME",
	 "FI_CONTROLLING_PERSON_ID",
	 "FI_CONTROLLING_PERSON_CODE",
	 "FI_CONTROLLING_PERSON_FULL_NAME",
	 "EXCEPTION_MESSAGE",
	 "UDV_CREATED_BY",
	 "UDV_CREATED_ON",
	 "ORG_CREATED_BY",
	 "ORG_CREATED_ON",
	 "CREATED_BY",
	 "CREATED_ON",
	 "UPDATED_BY",
	 "UPDATED_ON",
	 "STATUS_ID",
	 "CLIENT_NAME",
	 "COMMENT",
	 "STATUS",
	 "ASSIGNED_TO",
	 "ASSIGNED_BY",
	 "ASSIGNED_ON",
	 "REPLACED_FROM" ) AS SELECT
	 DATASET_FIELD_VALIDATION."DATASET_FIELD_VALIDATION_ID",
	 DATASET_FIELD_VALIDATION."SEQUENCE_ID",
	 DATASET_FIELD."DATASET_FIELD_ID",
	 DATASET_FIELD."FIELD_NAME" AS "DATASET_FIELD_NAME",
	 DATASET_FIELD."DESCRIPTION" AS "DATASET_FIELD_DESCRIPTION",
	 DATASET_TYPE."DATASET_TYPE_ID",
	 DATASET_TYPE."DATASET_TYPE_NAME",
	 DATASET_TYPE."DESCRIPTION" AS "DATASET_TYPE_DESCRIPTION",
	 DATASET_FIELD_VALIDATION."DM_DATASET_TYPE_ID",
	 DATASET_FIELD_VALIDATION."DM_NK_FIELD_ID",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_FIELD_VALIDATION."FIELD_VALUE" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND ( DATASET_FIELD_UDV."UDV" = '<del>' 
	OR DATASET_FIELD_UDV."UDV" = '04-01-0001' ) 
THEN DATASET_FIELD_VALIDATION."FIELD_VALUE" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND ( DATASET_FIELD_UDV."UDV" IS NULL 
	OR DATASET_FIELD_UDV."UDV" = '02-01-0001' ) 
THEN '' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV."UDV" IS NOT NULL 
THEN DATASET_FIELD_UDV."UDV" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_FIELD_VALIDATION."FIELD_VALUE" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_UDV_ID" IS NOT NULL 
THEN CASE WHEN DATASET_FIELD_UDV_PRIOR."UDV" IS NULL 
THEN '' WHEN DATASET_FIELD_UDV_PRIOR."UDV" = '<del>' 
OR DATASET_FIELD_UDV_PRIOR."UDV" = '04-01-0001' 
THEN '' 
ELSE DATASET_FIELD_UDV_PRIOR."UDV" 
END WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_FIELD_VALIDATION."FIELD_VALUE" 
ELSE DATASET_FIELD_VALIDATION."FIELD_VALUE" 
END AS "FIELD_VALUE",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
THEN '' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."UDV" IS NOT NULL 
AND DATASET_FIELD_UDV."UDV" <> '<del>' 
AND DATASET_FIELD_UDV."UDV" <> '04-01-0001' 
THEN DATASET_FIELD_UDV."UDV" 
ELSE '' 
END AS "UDV",
	 BUSINESS_RULE_EXCEPTION."EXCEPTION_CODE" AS "EXCEPTION_CODE",
	 BUSINESS_RULE_EXCEPTION."SEVERITY" AS "EXCEPTION_SEVERITY",
	 OBLIGATION_TD."TAX_YEAR",
	 DATASET_FIELD_VALIDATION."OBLIGATION_ID",
	 OBLIGATION_TD."FI_ID",
	 OBLIGATION_TD."ENTITY_ID",
	 OBLIGATION_TD.ENTITY."ENTITY_CODE",
	 OBLIGATION_TD.ENTITY."ENTITY_NAME",
	 FI_ACCOUNT."FI_ACCOUNT_ID",
	 FI_ACCOUNT."FI_ACCOUNT_CODE",
	 FI_ACCOUNT."FI_ACCOUNT_NAME",
	 FI_HOLDER."FI_HOLDER_ID",
	 FI_HOLDER."FI_HOLDER_CODE",
	 FI_HOLDER."FULL_NAME" AS "FI_HOLDER_FULL_NAME",
	 FI_CONTROLLING_PERSON."FI_CONTROLLING_PERSON_ID",
	 FI_CONTROLLING_PERSON."FI_CONTROLLING_PERSON_CODE",
	 IFNULL(FI_CONTROLLING_PERSON."FIRST_NAME" || ' ',
	 '') || IFNULL(FI_CONTROLLING_PERSON."LAST_NAME",
	 '') AS "FI_CONTROLLING_PERSON_FULL_NAME",
	 BUSINESS_RULE_EXCEPTION."DESCRIPTION" AS "EXCEPTION_MESSAGE",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
THEN '' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."UDV" = '<del>' 
THEN '' 
ELSE DATASET_UDV."CREATED_BY" 
END AS "UDV_CREATED_BY",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
THEN '' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."UDV" = '<del>' 
THEN '' 
ELSE DATASET_UDV."CREATED_ON" 
END AS "UDV_CREATED_ON",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_ORG."DATASET_NAME" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND ( DATASET_FIELD_UDV."UDV" = '<del>' 
	OR DATASET_FIELD_UDV."UDV" = '04-01-0001' ) 
THEN DATASET_ORG."DATASET_NAME" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND ( DATASET_FIELD_UDV."UDV" IS NULL 
	OR DATASET_FIELD_UDV."UDV" = '02-01-0001' ) 
THEN DATASET_UDV."CREATED_BY" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV."UDV" IS NOT NULL 
THEN DATASET_UDV."CREATED_BY" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_ORG."DATASET_NAME" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_UDV_ID" IS NOT NULL 
THEN DATASET_UDV_PRIOR."CREATED_BY" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_ORG."DATASET_NAME" 
ELSE DATASET_ORG."DATASET_NAME" 
END AS "ORG_CREATED_BY",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_ORG."CREATED_ON" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND ( DATASET_FIELD_UDV."UDV" = '<del>' 
	OR DATASET_FIELD_UDV."UDV" = '04-01-0001' ) 
THEN DATASET_ORG."CREATED_ON" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND ( DATASET_FIELD_UDV."UDV" IS NULL 
	OR DATASET_FIELD_UDV."UDV" = '02-01-0001' ) 
THEN DATASET_UDV."CREATED_ON" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV."UDV" IS NOT NULL 
THEN DATASET_UDV."CREATED_ON" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_ORG."CREATED_ON" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_UDV_ID" IS NOT NULL 
THEN DATASET_UDV_PRIOR."CREATED_ON" WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."DATASET_FIELD_UDV_ID" IS NOT NULL 
AND DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_UDV_ID" IS NULL 
THEN DATASET_ORG."CREATED_ON" 
ELSE DATASET_ORG."CREATED_ON" 
END AS "ORG_CREATED_ON",
	 DATASET_FIELD_VALIDATION."CREATED_BY",
	 DATASET_FIELD_VALIDATION."CREATED_ON",
	 DATASET_FIELD_VALIDATION."UPDATED_BY",
	 DATASET_FIELD_VALIDATION."UPDATED_ON",
	 DATASET_FIELD_VALIDATION."STATUS_ID",
	 CLIENT."CLIENT_NAME" AS "CLIENT_NAME",
	 IFNULL(DATASET_FIELD_UDV."COMMENT",
	 '') AS "COMMENT",
	 CASE WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND IFNULL(DATASET_FIELD_ASSIGN."USER_ID",
	 0) = 0 
THEN 'UNASSIGNED' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
AND IFNULL(DATASET_FIELD_ASSIGN."USER_ID",
	 0) != 0 
THEN 'ASSIGNED' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."IS_APPROVED" = 0 
THEN 'UNAPPROVED' WHEN DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
AND DATASET_FIELD_UDV."IS_APPROVED" = 1 
THEN 'APPROVED' 
ELSE 'REMOVED' 
END AS "STATUS",
	 IFNULL(DATASET_FIELD_ASSIGN."ASSIGNED_TO",
	 '') AS "ASSIGNED_TO",
	 CASE WHEN IFNULL(DATASET_FIELD_ASSIGN."ASSIGNED_TO",
	 '') = '' 
THEN '' 
ELSE DATASET_FIELD_ASSIGN."UPDATED_BY" 
END AS "ASSIGNED_BY",
	 CASE WHEN IFNULL(DATASET_FIELD_ASSIGN."ASSIGNED_TO",
	 '') = '' 
THEN '' 
ELSE DATASET_FIELD_ASSIGN."UPDATED_ON" 
END AS "ASSIGNED_ON",
	 CASE WHEN DATASET_UDV."STATUS_ID" = 13 
THEN DATASET_UDV."CREATED_BY" 
ELSE DATASET_UDV."DATASET_NAME" 
END AS "REPLACED_FROM" 
FROM "DATASET_FIELD_VALIDATION" AS DATASET_FIELD_VALIDATION 
INNER JOIN "VW_OBLIGATION_TD" AS OBLIGATION_TD ON OBLIGATION_TD."OBLIGATION_ID" = DATASET_FIELD_VALIDATION."OBLIGATION_ID" 
LEFT JOIN "VW_DATASET_FIELD_UDV" AS DATASET_FIELD_UDV ON DATASET_FIELD_VALIDATION."DATASET_FIELD_ID" = DATASET_FIELD_UDV."DATASET_FIELD_ID" 
AND OBLIGATION_TD."TAX_PERIOD_ID" = DATASET_FIELD_UDV."TAX_PERIOD_ID" 
AND DATASET_FIELD_VALIDATION."DM_DATASET_TYPE_ID" = DATASET_FIELD_UDV."DM_DATASET_TYPE_ID" 
AND DATASET_FIELD_VALIDATION.DM_NK_FIELD_ID = DATASET_FIELD_UDV."DM_NK_FIELD_ID" 
AND DATASET_FIELD_UDV."ROW_NUM" = 1 
LEFT JOIN "DATASET" AS DATASET_UDV ON DATASET_UDV."DATASET_ID" = DATASET_FIELD_UDV."DATASET_ID" 
LEFT JOIN "VW_DATASET_FIELD_UDV" AS DATASET_FIELD_UDV_PRIOR ON DATASET_FIELD_VALIDATION."DATASET_FIELD_ID" = DATASET_FIELD_UDV_PRIOR."DATASET_FIELD_ID" 
AND OBLIGATION_TD."TAX_PERIOD_ID" = DATASET_FIELD_UDV_PRIOR."TAX_PERIOD_ID" 
AND DATASET_FIELD_VALIDATION."DM_DATASET_TYPE_ID" = DATASET_FIELD_UDV_PRIOR."DM_DATASET_TYPE_ID" 
AND DATASET_FIELD_VALIDATION.DM_NK_FIELD_ID = DATASET_FIELD_UDV_PRIOR."DM_NK_FIELD_ID" 
AND DATASET_FIELD_UDV_PRIOR."ROW_NUM" = 2 
LEFT JOIN "DATASET" AS DATASET_UDV_PRIOR ON DATASET_UDV_PRIOR."DATASET_ID" = DATASET_FIELD_UDV_PRIOR."DATASET_ID" 
LEFT JOIN "DATASET_FIELD" AS DATASET_FIELD ON DATASET_FIELD."DATASET_FIELD_ID" = DATASET_FIELD_VALIDATION."DATASET_FIELD_ID" 
AND DATASET_FIELD."STATUS_ID" = 1 
LEFT JOIN "DATASET_TYPE" AS DATASET_TYPE ON DATASET_TYPE."DATASET_TYPE_ID" = DATASET_FIELD."DATASET_TYPE_ID" 
AND DATASET_TYPE."STATUS_ID" = 1 
LEFT JOIN "DATASET" AS DATASET_ORG ON DATASET_ORG."DATASET_ID" = DATASET_FIELD_VALIDATION."CREATED_DATASET_ID" 
LEFT JOIN "BUSINESS_RULE_EXCEPTION" AS BUSINESS_RULE_EXCEPTION ON BUSINESS_RULE_EXCEPTION."EXCEPTION_CODE" = DATASET_FIELD_VALIDATION."EXCEPTION_CODE" 
AND BUSINESS_RULE_EXCEPTION."STATUS_ID" = 1 
LEFT JOIN "FI_ACCOUNT" AS FI_ACCOUNT ON FI_ACCOUNT."FI_ACCOUNT_ID" = DATASET_FIELD_VALIDATION."FI_ACCOUNT_ID" 
AND FI_ACCOUNT."EFF_FROM_DATE" = OBLIGATION_TD."TAX_PERIOD_END" 
AND FI_ACCOUNT."STATUS_ID" = 16 
LEFT JOIN "FI_HOLDER" AS FI_HOLDER ON FI_HOLDER."FI_HOLDER_ID" = DATASET_FIELD_VALIDATION."FI_HOLDER_ID" 
AND FI_HOLDER."EFF_FROM_DATE" = OBLIGATION_TD."TAX_PERIOD_END" 
AND FI_HOLDER."STATUS_ID" = 16 
LEFT JOIN "FI_CONTROLLING_PERSON" AS FI_CONTROLLING_PERSON ON FI_CONTROLLING_PERSON."FI_CONTROLLING_PERSON_ID" = DATASET_FIELD_VALIDATION."FI_CONTROLLING_PERSON_ID" 
AND FI_CONTROLLING_PERSON."EFF_FROM_DATE" = OBLIGATION_TD."TAX_PERIOD_END" 
AND FI_CONTROLLING_PERSON."STATUS_ID" = 16 
LEFT JOIN "CLIENT" CLIENT ON CLIENT."CLIENT_SCHEMA" = 'SOURCE_AEOIV2_TEMPLATE' 
AND CLIENT."STATUS_ID" = 1 
LEFT JOIN "DATASET_FIELD_ASSIGN" AS DATASET_FIELD_ASSIGN ON DATASET_FIELD_ASSIGN."DATASET_FIELD_VALIDATION_ID" = DATASET_FIELD_VALIDATION."DATASET_FIELD_VALIDATION_ID" 
AND DATASET_FIELD_ASSIGN."STATUS_ID" = 1 
WHERE ( DATASET_FIELD_VALIDATION."STATUS_ID" = 1 
	OR ( DATASET_FIELD_VALIDATION."STATUS_ID" = 2 
		AND IFNULL(DATASET_FIELD_UDV."UDV",
	 '') NOT IN ('<del>',
	 '') ) ) WITH READ ONLY