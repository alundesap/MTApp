VIEW "VW_JURISDICTION_DUE_DATE" ( "JURISDICTION_ID",
	 "ISO_CODE2",
	 "JURISDICTION_NAME",
	 "TAX_PERIOD_ID",
	 "TAX_PERIOD_NAME",
	 "TAX_PERIOD_CODE",
	 "TAX_YEAR",
	 "OBLIGATION_TYPE_ID",
	 "OBLIGATION_TYPE_NAME",
	 "JURISDICTION_DUE_DATE_ID",
	 "JURISDICTION_DUE_DATE_TYPE_ID",
	 "ORIGINAL_DUE_DATE",
	 "EXTENDED_DUE_DATE",
	 "COLLECT_DUE_DATE",
	 "REMEDIATE_DUE_DATE",
	 "ANALYZE_DUE_DATE",
	 "REVIEW_DUE_DATE",
	 "VERIFY_DUE_DATE",
	 "AUTHORIZE_DUE_DATE",
	 "FILE_DUE_DATE",
	 "CREATED_BY",
	 "CREATED_ON",
	 "UPDATED_BY",
	 "UPDATED_ON" ) AS SELECT
	 JURISDICTION."JURISDICTION_ID",
	 JURISDICTION."ISO_CODE2",
	 JURISDICTION."JURISDICTION_NAME",
	 OBLIGATION_SCOPE."TAX_PERIOD_ID",
	 OBLIGATION_SCOPE."TAX_PERIOD_NAME",
	 OBLIGATION_SCOPE."TAX_PERIOD_CODE",
	 OBLIGATION_SCOPE."TAX_YEAR",
	 OBLIGATION_TYPE."OBLIGATION_TYPE_ID",
	 OBLIGATION_TYPE."OBLIGATION_TYPE_NAME",
	 IFNULL(JURISDICTION_DUE_DATE."JURISDICTION_DUE_DATE_ID",
	 0) AS "JURISDICTION_DUE_DATE_ID",
	 IFNULL(JURISDICTION_DUE_DATE."JURISDICTION_DUE_DATE_TYPE_ID",
	 0) AS "JURISDICTION_DUE_DATE_TYPE_ID",
	 CASE WHEN OBLIGATION_TYPE."OBLIGATION_TYPE_ID" = 2 
THEN IFNULL(OBLIGATION_AGREEMENT."FATCA_FILING_DUE_DATE",
	 DATE '0001-01-02') WHEN OBLIGATION_TYPE."OBLIGATION_TYPE_ID" = 3 
THEN IFNULL(OBLIGATION_AGREEMENT."CRS_FILING_DUE_DATE",
	 DATE '0001-01-02') 
END AS "ORIGINAL_DUE_DATE",
	 CASE WHEN OBLIGATION_TYPE."OBLIGATION_TYPE_ID" = 2 
THEN IFNULL(OBLIGATION_AGREEMENT."FATCA_EXTENDED_DUE_DATE",
	 DATE '0001-01-02') WHEN OBLIGATION_TYPE."OBLIGATION_TYPE_ID" = 3 
THEN IFNULL(OBLIGATION_AGREEMENT."CRS_EXTENDED_DUE_DATE",
	 DATE '0001-01-02') 
END AS "EXTENDED_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."COLLECT_DUE_DATE",
	 DATE '0001-01-02') AS "COLLECT_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."REMEDIATE_DUE_DATE",
	 DATE '0001-01-02') AS "REMEDIATE_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."ANALYZE_DUE_DATE",
	 DATE '0001-01-02') AS "ANALYZE_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."REVIEW_DUE_DATE",
	 DATE '0001-01-02') AS "REVIEW_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."VERIFY_DUE_DATE",
	 DATE '0001-01-02') AS "VERIFY_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."AUTHORIZE_DUE_DATE",
	 DATE '0001-01-02') AS "AUTHORIZE_DUE_DATE",
	 IFNULL(PROJECT_MILESTONE_DUE_DATE."FILE_DUE_DATE",
	 DATE '0001-01-02') AS "FILE_DUE_DATE",
	 JURISDICTION_DUE_DATE."CREATED_BY",
	 JURISDICTION_DUE_DATE."CREATED_ON",
	 JURISDICTION_DUE_DATE."UPDATED_BY",
	 JURISDICTION_DUE_DATE."UPDATED_ON" 
FROM "JURISDICTION" JURISDICTION 
LEFT JOIN "VW_OBLIGATION_SCOPE" OBLIGATION_SCOPE ON OBLIGATION_SCOPE."STATUS_ID" = 1 
LEFT JOIN "OBLIGATION_TYPE" OBLIGATION_TYPE ON OBLIGATION_TYPE."OBLIGATION_TYPE_ID" > 0 
LEFT JOIN "OBLIGATION_AGREEMENT" OBLIGATION_AGREEMENT ON OBLIGATION_AGREEMENT."JURISDICTION_ID" = JURISDICTION."JURISDICTION_ID" 
AND OBLIGATION_AGREEMENT."TAX_PERIOD_ID" = OBLIGATION_SCOPE."TAX_PERIOD_ID" 
AND OBLIGATION_AGREEMENT."STATUS_ID" = 1 
LEFT JOIN "JURISDICTION_DUE_DATE" JURISDICTION_DUE_DATE ON JURISDICTION_DUE_DATE."JURISDICTION_ID" = JURISDICTION."JURISDICTION_ID" 
AND JURISDICTION_DUE_DATE."TAX_PERIOD_ID" = OBLIGATION_SCOPE."TAX_PERIOD_ID" 
AND JURISDICTION_DUE_DATE."OBLIGATION_TYPE_ID" = OBLIGATION_TYPE."OBLIGATION_TYPE_ID" 
AND JURISDICTION_DUE_DATE."STATUS_ID" = 1 
LEFT JOIN "PROJECT_MILESTONE_DUE_DATE" PROJECT_MILESTONE_DUE_DATE ON PROJECT_MILESTONE_DUE_DATE."JURISDICTION_ID" = JURISDICTION."JURISDICTION_ID" 
AND PROJECT_MILESTONE_DUE_DATE."TAX_PERIOD_ID" = OBLIGATION_SCOPE."TAX_PERIOD_ID" 
AND PROJECT_MILESTONE_DUE_DATE."OBLIGATION_TYPE_ID" = OBLIGATION_TYPE."OBLIGATION_TYPE_ID" 
AND PROJECT_MILESTONE_DUE_DATE."STATUS_ID" = 1 
WHERE JURISDICTION."JURISDICTION_TYPE_ID" = 1 
AND JURISDICTION."STATUS_ID" = 1 WITH READ ONLY