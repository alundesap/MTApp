CREATE VIEW "VW_ENTITY_SUPPRESSION" ( "ENTITY_CODE",
	 "ENTITY_ID",
	 "ENTITY_NAME",
	 "BUSINESS_UNIT",
	 "ENTITY_JURISDICTION",
	 "TAX_PERIOD_ID",
	 "TAX_PERIOD",
	 "OBLIGATION_TYPE_ID",
	 "OBLIGATION_TYPE_NAME",
	 "IS_SUPPRESS_ENTITY",
	 "IS_SUPPRESS_ACCOUNT",
	 "COMMENTS",
	 "ENTITY_EFF_FROM_DATE",
	 "ENTITY_EFF_THRU_DATE" ) AS SELECT
	 DISTINCT CASE WHEN ENTITY_EOP."ENTITY_ID" IS NOT NULL THEN IFNULL(ENTITY_EOP."ENTITY_CODE",'') 
ELSE IFNULL(ENTITY."ENTITY_CODE",	'') 
END AS "ENTITY_CODE",
	 ENTITY_SUPPRESSION."ENTITY_ID",
	 CASE WHEN ENTITY_EOP."ENTITY_ID" IS NOT NULL 
THEN IFNULL(ENTITY_EOP."ENTITY_NAME",
	'') 
ELSE IFNULL(ENTITY."ENTITY_NAME",
	'') 
END AS "ENTITY_NAME" ,
	 BUSINESS_SEGMENT."BUSINESS_SEGMENT_NAME" AS "BUSINESS_UNIT",
	 MAP(ENTITY_JURISDICTION."ISO_CODE2",
	'NULL',
	'',
	ENTITY_JURISDICTION."ISO_CODE2") AS "ENTITY_JURISDICTION",
	 ENTITY_SUPPRESSION."TAX_PERIOD_ID",
	 OBLIGATION_SCOPE."TAX_PERIOD_CODE" AS "TAX_PERIOD",
	 ENTITY_SUPPRESSION."OBLIGATION_TYPE_ID",
	 OBLIGATION_TYPE."OBLIGATION_TYPE_NAME" AS "OBLIGATION_TYPE_NAME",
	 MAP(ENTITY_SUPPRESSION."IS_SUPPRESS_ENTITY",
	1,
	'Yes',
	'No') AS "IS_SUPPRESS_ENTITY",
	 MAP(ENTITY_SUPPRESSION."IS_SUPPRESS_ACCOUNT",
	1,
	'Yes',
	'No') AS "IS_SUPPRESS_ACCOUNT",
	 ENTITY_SUPPRESSION."COMMENTS" AS "COMMENTS",
	 CASE WHEN ENTITY_EOP."ENTITY_ID" IS NOT NULL 
THEN IFNULL(ENTITY_EOP."EFF_FROM_DATE",
	 '') 
ELSE IFNULL(ENTITY."EFF_FROM_DATE",
	 '') 
END AS "ENTITY_EFF_FROM_DATE",
	 CASE WHEN ENTITY_EOP."ENTITY_ID" IS NOT NULL 
THEN IFNULL(ENTITY_EOP."EFF_THRU_DATE",
	'') 
ELSE IFNULL(ENTITY."EFF_THRU_DATE",
	'') 
END AS "ENTITY_EFF_THRU_DATE" 
FROM ENTITY_SUPPRESSION" ENTITY_SUPPRESSION 
INNER JOIN "VW_OBLIGATION_SCOPE" OBLIGATION_SCOPE ON OBLIGATION_SCOPE."TAX_PERIOD_ID" = ENTITY_SUPPRESSION."TAX_PERIOD_ID" 
LEFT JOIN "ENTITY" ENTITY_EOP ON ENTITY_SUPPRESSION."ENTITY_ID" = ENTITY_EOP."ENTITY_ID" 
AND ENTITY_EOP."STATUS_ID" = 16 
AND ENTITY_EOP."EFF_FROM_DATE" = OBLIGATION_SCOPE."TAX_PERIOD_END" 
LEFT JOIN "ENTITY" ENTITY ON ENTITY_SUPPRESSION."ENTITY_ID" = ENTITY."ENTITY_ID" 
AND ENTITY."STATUS_ID" = 1 
LEFT JOIN "JURISDICTION" AS ENTITY_JURISDICTION ON CASE WHEN ENTITY_EOP."ENTITY_ID" IS NOT NULL 
THEN IFNULL(ENTITY_EOP."JURISDICTION_ID",
	0) 
ELSE IFNULL(ENTITY."JURISDICTION_ID",
	0) 
END = ENTITY_JURISDICTION."JURISDICTION_ID" 
AND ENTITY_JURISDICTION."STATUS_ID" = 1 
LEFT JOIN "BUSINESS_SEGMENT" AS BUSINESS_SEGMENT ON CASE WHEN ENTITY_EOP."ENTITY_ID" IS NOT NULL 
THEN IFNULL(ENTITY_EOP."BUSINESS_SEGMENT_ID",
	0) 
ELSE IFNULL(ENTITY."BUSINESS_SEGMENT_ID",
	0) 
END = BUSINESS_SEGMENT."BUSINESS_SEGMENT_ID" 
AND BUSINESS_SEGMENT."STATUS_ID" = 1 
LEFT JOIN "OBLIGATION_TYPE" OBLIGATION_TYPE ON ENTITY_SUPPRESSION."OBLIGATION_TYPE_ID" = OBLIGATION_TYPE."OBLIGATION_TYPE_ID" 
AND OBLIGATION_TYPE."STATUS_ID" = 1 
WHERE ENTITY_SUPPRESSION."STATUS_ID" = 1 
ORDER BY ENTITY_ID WITH READ ONLY