VIEW "VW_OBLIGATION_SCOPE" ( "OBLIGATION_SCOPE_ID",
	 "IS_FATCA_VISIBLE",
	 "IS_CRS_VISIBLE",
	 "IS_DEFAULT_VIEW",
	 "IS_DEFINE_OBLIGATION",
	 "OBLIGATION_STATUS_ID",
	 "OBLIGATION_STATUS_NAME",
	 "EFF_FROM_TIME",
	 "EFF_THRU_TIME",
	 "TAX_PERIOD_ID",
	 "TAX_PERIOD_NAME",
	 "TAX_PERIOD_CODE",
	 "TAX_YEAR",
	 "DESCRIPTION",
	 "TAX_PERIOD_START",
	 "TAX_PERIOD_END",
	 "CREATED_BY",
	 "CREATED_ON",
	 "UPDATED_BY",
	 "UPDATED_ON",
	 "STATUS_ID" ) AS SELECT
	 OBLIGATION_SCOPE."OBLIGATION_SCOPE_ID",
	 OBLIGATION_SCOPE."IS_FATCA_VISIBLE" ,
	 OBLIGATION_SCOPE."IS_CRS_VISIBLE" ,
	 OBLIGATION_SCOPE."IS_DEFAULT_VIEW",
	 OBLIGATION_SCOPE."IS_DEFINE_OBLIGATION" ,
	 OBLIGATION_SCOPE."OBLIGATION_STATUS_ID",
	 OBLIGATION_STATUS."OBLIGATION_STATUS_NAME",
	 OBLIGATION_SCOPE."EFF_FROM_TIME",
	 OBLIGATION_SCOPE."EFF_THRU_TIME",
	 OBLIGATION_SCOPE."TAX_PERIOD_ID",
	 TX."TAX_PERIOD_NAME",
	 
RIGHT(TX."TAX_PERIOD_CODE",
	4) AS "TAX_PERIOD_CODE",
	 TX."TAX_YEAR",
	 TX."DESCRIPTION",
	 TX."TAX_PERIOD_START",
	 TX."TAX_PERIOD_END",
	 OBLIGATION_SCOPE."CREATED_BY",
	 OBLIGATION_SCOPE."CREATED_ON",
	 OBLIGATION_SCOPE."UPDATED_BY",
	 OBLIGATION_SCOPE."UPDATED_ON",
	 OBLIGATION_SCOPE."STATUS_ID" 
FROM "OBLIGATION_SCOPE" OBLIGATION_SCOPE 
INNER JOIN "TAX_PERIOD" TX ON TX."TAX_PERIOD_ID" = OBLIGATION_SCOPE."TAX_PERIOD_ID" 
AND TX."STATUS_ID" = 1 
LEFT JOIN "OBLIGATION_STATUS" OBLIGATION_STATUS ON OBLIGATION_STATUS."OBLIGATION_STATUS_ID" = OBLIGATION_SCOPE."OBLIGATION_STATUS_ID" 
AND OBLIGATION_STATUS."STATUS_ID" = 1 
WHERE (OBLIGATION_SCOPE."TAX_PERIOD_ID",
	OBLIGATION_SCOPE."EFF_FROM_TIME") IN ( SELECT
	 "TAX_PERIOD_ID",
	 MAX("EFF_FROM_TIME") 
	FROM "OBLIGATION_SCOPE" 
	WHERE "STATUS_ID" = 1 
	GROUP BY "TAX_PERIOD_ID" ) 
AND OBLIGATION_SCOPE."STATUS_ID" = 1 
ORDER BY OBLIGATION_SCOPE."TAX_PERIOD_ID" WITH READ ONLY